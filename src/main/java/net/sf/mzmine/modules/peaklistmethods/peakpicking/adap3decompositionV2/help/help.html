<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" type="text/css" href="/net/sf/mzmine/desktop/impl/helpsystem/HelpStyles.css">

    <title>Peak detection - Spectral deconvolution</title>

    <style>
        em {color: blue;}
    </style>
</head>
<body>



<h1>Spectral deconvolution / Blind Source Separation</h1>

<p>
    This method performs Spectral Deconvolution of detected peaks. It finds components (compounds, analytes, etc.) and
    determines their elution profiles and fragmentation mass spectra.
</p>
<p>
    The spectral deconvolution uses both constructed chromatograms and detected peaks. The list of constructed
    chromatograms is specified by selecting <i>Specific peak lists</i> for parameter <em>Chromatograms</em>, clicking
    on the ellipsis button, and choosing one or more lists with chromatograms in the popup window. The list of
    detected peaks is specified by selecting <i>Specific peak lists</i> for parameter <em>Peaks</em>, clicking on the
    ellipsis button, and choosing one or more lists with detected peaks in the popup window.
</p>

<p>
<div align="center">
    <img src="spectral_deconvolution_window.png" alt="Spectral Deconvolution Window">
</div>
</p>

<p>
    The Spectral Deconvolution consists of two steps:
</p>
<ol>
    <li>
        <p>Entire retention time interval is split into deconvolution windows so that<p/>
        <ul>
            <li>Peaks produced by the same component or by coeluting components belong to the same deconvolution window,</li>
            <li>Number of peaks in deconvolution window is significantly smaller than the total number of peaks.</li>
        </ul>
        <p>
            The deconvolution windows are displayed in the top plot of the preview, where small dash lines denote peaks
            in the (retention time, m/z)-plane, and peaks belonging to one deconvolution window have the same color.
            The vertical sequences of peaks usually mark the presence of one or several compounds, so it is important
            that those peaks are assigned to the same deconvolution window, i.e. they have the same color on the plot. On
            the other hand, if deconvolution windows contain too many peaks, it will significantly slow down the spectral
            deconvolution computations, so the deconvolution windows should be as short (in the retention time domain) as
            possible.
        </p>
        <p>The following two parameters control the deconvolution window selection:</p>
        <ul>
            <li><em>Preferred window width (min)</em> - The algorithm will <span style="color: red;">try</span> to
                produce deconvolution windows so that their width (in retention time domain) does not exceed the value
                of this parameter. However, the algorithm can fail to produce deconvolution windows of the
                specified width if there are too many peaks.</li>
            <li><em>Min number of peaks</em> - Each deconvolution window will contain at least the specified number of
                peaks.</li>
        </ul>
    </li>

    <li>
        <p>The algorithm infers the number of components in each deconvolution window and construct their
        elution profiles and fragmentation spectra. The inferred number of components is controlled by parameter
        <em>Retention time tolerance (min)</em>, which is the smallest time-gap between any two components. The shape
        of constructed elution profiles is constrained by the following two parameters:</p>
        <ul>
            <li><em>Smoothed elution profiles</em> - If checked, elution profiles of components are smoothed using
                the moving average algorithm,</li>
            <li><em>Unimodal elution profiles</em> - If checked, each elution profile has only one local maximum.</li>
        </ul>
    </li>
</ol>



</body>
</html>